import{r as N,c7 as V,aO as yt,l as J,j as w,ba as ht,bq as bt,c8 as wt,bK as St,e as ue,C as ye}from"./main-1.0.5.js";import{v as Tt,B as be,a1 as Et,T as Ot,ae as jt,a3 as xt}from"./main-1.0.5-a7d73e33.js";import{P as te}from"./DialogContent-1.0.5-383cf0b4.js";import{e as _t,f as Rt}from"./index.esm-1.0.5-d46b99b8.js";import{d as Ct}from"./ActionsDml-1.0.5-5478d97e.js";import{C as At}from"./settings-1.0.5-a609f2d7.js";import{u as Lt}from"./TableContainer-1.0.5-6eccc43a.js";import{B as we}from"./AdminTheme-1.0.5-04bcac94.js";import{P as Nt}from"./TextField-1.0.5-7ecf712b.js";import{T as kt,I as Pt}from"./iconBase-1.0.5-f30be7a9.js";import{R as Bt}from"./RadioGroup-1.0.5-2e2c1c10.js";import{F as re}from"./FormControlLabel-1.0.5-d0651878.js";import{R as ne}from"./Radio-1.0.5-9d423ffa.js";import"./Close-1.0.5-697e5a3b.js";import"./Tabs-1.0.5-8b2f6dd8.js";import"./index.esm-1.0.5-4bc9dd12.js";import"./MenuItem-1.0.5-151020c5.js";import"./Checkbox-1.0.5-abd3391a.js";import"./AlertTitle-1.0.5-2a211bdd.js";import"./useSlot-1.0.5-9b11ffd5.js";import"./InputAdornment-1.0.5-b81a1094.js";import"./DateTimePicker-1.0.5-f2511f2b.js";import"./useMobilePicker-1.0.5-94af1d31.js";import"./date-time-utils-1.0.5-d782c334.js";import"./dateViewRenderers-1.0.5-ca3d57b4.js";import"./TimePicker-1.0.5-a761c18a.js";import"./DatePicker-1.0.5-3533cde7.js";import"./ScopeEnum-1.0.5-02ab575a.js";import"./useStoreTable-1.0.5-ca420c38.js";import"./index.esm-1.0.5-cbf5a94b.js";import"./index-1.0.5-565e836d.js";import"./vi-1.0.5-b29d2783.js";import"./dayjs.min-1.0.5-ef136ab2.js";function oe(e){if(typeof window>"u")return e;const t=N.useRef(null);return N.useLayoutEffect(()=>{t.current=e}),N.useCallback((...a)=>{var s;(s=t.current)===null||s===void 0||s.call(t,...a)},[])}const Ie={};function Ft(e,t){Ie[e]||(Ie[e]=!0,console.error("[material-ui-popup-state] WARNING",t))}const Mt={isOpen:!1,setAnchorElUsed:!1,anchorEl:void 0,anchorPosition:void 0,hovered:!1,focused:!1,_openEventType:null,_childPopupState:null,_deferNextOpen:!1,_deferNextClose:!1};function It({parentPopupState:e,popupId:t,variant:a,disableAutoFocus:s}){const h=N.useRef(!0);N.useEffect(()=>(h.current=!0,()=>{h.current=!1}),[]);const[g,y]=N.useState(Mt),l=N.useCallback(f=>{h.current&&y(f)},[]),x=N.useCallback(f=>l(i=>({...i,setAnchorElUsed:!0,anchorEl:f??void 0})),[]),c=oe(f=>(g.isOpen?m(f):p(f),g)),p=oe(f=>{const i=f instanceof Element?void 0:f,E=f instanceof Element?f:(f==null?void 0:f.currentTarget)instanceof Element?f.currentTarget:void 0;if((i==null?void 0:i.type)==="touchstart"){l(C=>({...C,_deferNextOpen:!0}));return}const I=i==null?void 0:i.clientX,H=i==null?void 0:i.clientY,D=typeof I=="number"&&typeof H=="number"?{left:I,top:H}:void 0,K=C=>{if(!f&&!C.setAnchorElUsed&&a!=="dialog"&&Ft("missingEventOrAnchorEl","eventOrAnchorEl should be defined if setAnchorEl is not used"),e){if(!e.isOpen)return C;setTimeout(()=>e._setChildPopupState(_))}const X={...C,isOpen:!0,anchorPosition:D,hovered:(i==null?void 0:i.type)==="mouseover"||C.hovered,focused:(i==null?void 0:i.type)==="focus"||C.focused,_openEventType:i==null?void 0:i.type};return i!=null&&i.currentTarget?C.setAnchorElUsed||(X.anchorEl=i==null?void 0:i.currentTarget):E&&(X.anchorEl=E),X};l(C=>C._deferNextOpen?(setTimeout(()=>l(K),0),{...C,_deferNextOpen:!1}):K(C))}),O=f=>{const{_childPopupState:i}=f;return setTimeout(()=>{i==null||i.close(),e==null||e._setChildPopupState(null)}),{...f,isOpen:!1,hovered:!1,focused:!1}},m=oe(f=>{const i=f instanceof Element?void 0:f;if((i==null?void 0:i.type)==="touchstart"){l(E=>({...E,_deferNextClose:!0}));return}l(E=>E._deferNextClose?(setTimeout(()=>l(O),0),{...E,_deferNextClose:!1}):O(E))}),S=N.useCallback((f,i)=>{f?p(i):m(i)},[]),q=oe(f=>{const{relatedTarget:i}=f;l(E=>E.hovered&&!(i instanceof Element&&Se(i,_))?E.focused?{...E,hovered:!1}:O(E):E)}),R=oe(f=>{if(!f)return;const{relatedTarget:i}=f;l(E=>E.focused&&!(i instanceof Element&&Se(i,_))?E.hovered?{...E,focused:!1}:O(E):E)}),T=N.useCallback(f=>l(i=>({...i,_childPopupState:f})),[]),_={...g,setAnchorEl:x,popupId:t,variant:a,open:p,close:m,toggle:c,setOpen:S,onBlur:R,onMouseLeave:q,disableAutoFocus:s??!!(g.hovered||g.focused),_setChildPopupState:T};return _}function Ut({isOpen:e,popupId:t,variant:a}){return{...a==="popover"?{"aria-haspopup":!0,"aria-controls":e&&t!=null?t:void 0}:a==="popper"?{"aria-describedby":e&&t!=null?t:void 0}:void 0}}function qt(e){return{...Ut(e),onClick:e.open,onTouchStart:e.open}}function Ht({isOpen:e,anchorEl:t,anchorPosition:a,close:s,popupId:h,onMouseLeave:g,disableAutoFocus:y,_openEventType:l}){return{id:h,anchorEl:t,anchorPosition:a,anchorReference:l==="contextmenu"?"anchorPosition":"anchorEl",open:e,onClose:s,onMouseLeave:g,...y&&{disableAutoFocus:!0,disableEnforceFocus:!0,disableRestoreFocus:!0}}}function Xt(e,{popupId:t}){if(!t)return null;const a=typeof e.getRootNode=="function"?e.getRootNode():document;return typeof a.getElementById=="function"?a.getElementById(t):null}function Se(e,t){const{anchorEl:a,_childPopupState:s}=t;return Ue(a,e)||Ue(Xt(e,t),e)||s!=null&&Se(e,s)}function Ue(e,t){if(!e)return!1;for(;t;){if(t===e)return!0;t=t.parentElement}return!1}function Ge({children:e,popupId:t,variant:a,parentPopupState:s,disableAutoFocus:h}){const g=It({popupId:t,variant:a,parentPopupState:s,disableAutoFocus:h}),y=e(g);return y??null}Ge.propTypes={children:te.func.isRequired,popupId:te.string,variant:te.oneOf(["popover","popper"]).isRequired,parentPopupState:te.object,disableAutoFocus:te.bool};var Gt={fieldSeparator:",",decimalSeparator:".",quoteStrings:!0,quoteCharacter:'"',showTitle:!1,title:"My Generated Report",filename:"generated",showColumnHeaders:!0,useTextFile:!1,useBom:!0,columnHeaders:[],useKeysAsHeaders:!1,boolDisplay:{true:"TRUE",false:"FALSE"},replaceUndefinedWith:""},Jt=`\r
`,Dt="\uFEFF",Te=e=>Object.assign({},Gt,e);class Kt extends Error{constructor(t){super(t),this.name="CsvGenerationError"}}class $t extends Error{constructor(t){super(t),this.name="EmptyHeadersError"}}class Wt extends Error{constructor(t){super(t),this.name="CsvDownloadEnvironmentError"}}var ae=e=>e,F=e=>e,le=ae,z=ae,qe=ae,He=ae,Yt=function(e,t){return t=='"'&&e.indexOf('"')>-1?e.replace(/"/g,'""'):e},Vt=e=>qe(typeof e=="object"?e.key:e),zt=e=>He(typeof e=="object"?e.displayLabel:e),Qt=(e,...t)=>t.reduce((a,s)=>s(a),e),Zt=e=>t=>e.useBom?le(F(t)+Dt):t,er=e=>t=>e.showTitle?Ee(le(F(t)+e.title))(z("")):t,Ee=e=>t=>le(F(e)+F(t)+Jt),Je=e=>(t,a)=>tr(e)(z(t+a)),tr=e=>t=>ae(F(t)+e.fieldSeparator),rr=(e,t)=>a=>{if(!e.showColumnHeaders)return a;if(t.length<1)throw new $t("Option to show headers but none supplied. Make sure there are keys in your collection or that you've supplied headers through the config options.");let s=z("");for(let h=0;h<t.length;h++){const g=zt(t[h]);s=Je(e)(s,De(e,g))}return s=z(F(s).slice(0,-1)),Ee(a)(s)},nr=(e,t,a)=>s=>{let h=s;for(var g=0;g<a.length;g++){let y=z("");for(let l=0;l<t.length;l++){const x=Vt(t[l]),c=typeof a[g][F(x)]>"u"?e.replaceUndefinedWith:a[g][F(x)];y=Je(e)(y,De(e,c))}y=z(F(y).slice(0,-1)),h=Ee(h)(y)}return h},Xe=e=>+e===e&&(!isFinite(e)||!!(e%1)),De=(e,t)=>{if(e.decimalSeparator==="locale"&&Xe(t))return t.toLocaleString();if(e.decimalSeparator!=="."&&Xe(t))return t.toString().replace(".",e.decimalSeparator);if(typeof t=="string"){let a=t;return(e.quoteStrings||e.fieldSeparator&&t.indexOf(e.fieldSeparator)>-1||e.quoteCharacter&&t.indexOf(e.quoteCharacter)>-1||t.indexOf(`
`)>-1||t.indexOf("\r")>-1)&&(a=e.quoteCharacter+Yt(t,e.quoteCharacter)+e.quoteCharacter),a}if(typeof t=="boolean"&&e.boolDisplay){const a=t?"true":"false";return e.boolDisplay[a]}return t},or=e=>t=>{const a=Te(e),s=a.useKeysAsHeaders?Object.keys(t[0]):a.columnHeaders;let h=Qt(le(""),Zt(a),er(a),rr(a,s),nr(a,s,t));if(F(h).length<1)throw new Kt("Output is empty. Is your data formatted correctly?");return h},ar=e=>t=>{if(!window)throw new Wt("Downloading only supported in a browser environment.");const a=Te(e),s=F(t),h=a.useTextFile?"plain":"csv",g=a.useTextFile?"txt":"csv";let y=new Blob([s],{type:`text/${h};charset=utf8;`}),l=document.createElement("a");l.download=`${a.filename}.${g}`,l.href=URL.createObjectURL(y),l.setAttribute("visibility","hidden"),document.body.appendChild(l),l.click(),document.body.removeChild(l)},Ke={};(function(e){(function(t,a){a(e)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:V,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.toXML=void 0;function a(n){return g(n)||h(n)||O(n)||s()}function s(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function h(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function g(n){if(Array.isArray(n))return m(n)}function y(n,r){var o=Object.keys(n);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(n);r&&(b=b.filter(function(j){return Object.getOwnPropertyDescriptor(n,j).enumerable})),o.push.apply(o,b)}return o}function l(n){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?y(Object(o),!0).forEach(function(b){x(n,b,o[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):y(Object(o)).forEach(function(b){Object.defineProperty(n,b,Object.getOwnPropertyDescriptor(o,b))})}return n}function x(n,r,o){return r in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,n}function c(n,r){return q(n)||S(n,r)||O(n,r)||p()}function p(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function O(n,r){if(n){if(typeof n=="string")return m(n,r);var o=Object.prototype.toString.call(n).slice(8,-1);if(o==="Object"&&n.constructor&&(o=n.constructor.name),o==="Map"||o==="Set")return Array.from(n);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return m(n,r)}}function m(n,r){(r==null||r>n.length)&&(r=n.length);for(var o=0,b=new Array(r);o<r;o++)b[o]=n[o];return b}function S(n,r){var o=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(o!=null){var b=[],j=!0,L=!1,k,P;try{for(o=o.call(n);!(j=(k=o.next()).done)&&(b.push(k.value),!(r&&b.length===r));j=!0);}catch(M){L=!0,P=M}finally{try{!j&&o.return!=null&&o.return()}finally{if(L)throw P}}return b}}function q(n){if(Array.isArray(n))return n}function R(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?R=function(o){return typeof o}:R=function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},R(n)}var T={ARRAY:"array",BOOLEAN:"boolean",DATE:"date",FUNCTION:"function",JSTOXML_OBJECT:"jstoxml-object",NULL:"null",NUMBER:"number",OBJECT:"object",STRING:"string"},_=[T.STRING,T.NUMBER,T.BOOLEAN],f='<?xml version="1.0" encoding="UTF-8"?>',i=["_selfCloseTag","_attrs"],E=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return r.repeat(o)},I=function(r){return Array.isArray(r)&&T.ARRAY||R(r)===T.OBJECT&&r!==null&&r._name&&T.JSTOXML_OBJECT||r instanceof Date&&T.DATE||r===null&&T.NULL||R(r)},H=function(r){return r.startsWith("<![CDATA[")},D=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},b=arguments.length>2?arguments[2]:void 0,j=r;if(R(r)===T.STRING){if(H(r))return r;var L=new RegExp("(".concat(Object.keys(o).join("|"),")(?!(\\w|#)*;)"),"g");j=String(r).replace(L,function(k,P){return o[P]||""})}return typeof b=="function"?b(j):j},K=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0,b=arguments.length>2?arguments[2]:void 0,j=arguments.length>3?arguments[3]:void 0,L=Array.isArray(r)?r:Object.entries(r).map(function(k){var P=c(k,2),M=P[0],G=P[1];return x({},M,G)});return L.reduce(function(k,P){var M=Object.keys(P)[0],G=P[M];if(R(b)===T.FUNCTION){var ie=b(M,G);if(ie)return k}var $=o?D(G,o):G,de=!j&&$===!0?"":'="'.concat($,'"');return k.push("".concat(M).concat(de)),k},[])},C=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0,b=arguments.length>2?arguments[2]:void 0,j=arguments.length>3?arguments[3]:void 0,L=K(r,o,b,j);if(L.length===0)return"";var k=L.join(" ");return" ".concat(k)},X=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.keys(r).map(function(o){return{_name:o,_content:r[o]}})},ce=function(r){return _.includes(I(r))},fe=function(r){return!r.match("<")},v=function(r){var o=r.header,b=r.isOutputStart,j=o&&b;if(!j)return"";var L=R(o)===T.BOOLEAN;return L?f:o},d={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;"},u=function n(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},b=o.depth,j=b===void 0?0:b,L=o.indent,k=o._isFirstItem,P=o._isOutputStart,M=P===void 0?!0:P,G=o.header,ie=o.attributeReplacements,$=ie===void 0?{}:ie,de=o.attributeFilter,Oe=o.attributeExplicitTrue,We=Oe===void 0?!1:Oe,je=o.contentReplacements,pe=je===void 0?{}:je,xe=o.contentMap,_e=o.selfCloseTags,Ye=_e===void 0?!0:_e,Ve=typeof $=="boolean"&&!$,ze=Ve?{}:l(l({},d),$),Qe=typeof pe=="boolean"&&!pe,Ze=Qe?{}:l(l({},d),pe),Re=typeof L=="string",me=E(L,j),et=I(r),Ce=v({header:G,indent:L,depth:j,isOutputStart:M}),se=M&&!Ce&&k&&j===0,Ae=Re&&!se?`
`:"",U="";switch(et){case T.JSTOXML_OBJECT:{var W=r._name,Y=r._content;if(Y===null&&typeof xe!="function"){U="".concat(Ae).concat(me).concat(W);break}var tt=Array.isArray(Y)&&Y.every(ce);if(tt){var rt=Y.map(function(B){return n({_name:W,_content:B},l(l({},o),{},{depth:j,_isOutputStart:!1}))});return rt.join("")}if(i.includes(W))break;var Q=n(Y,l(l({},o),{},{depth:j+1,_isOutputStart:se})),nt=I(Q),ot=fe(Q),at=H(Q),Le="".concat(Ae).concat(me);if(W==="_comment"){U+="".concat(Le,"<!-- ").concat(Y," -->");break}var Ne=nt==="undefined"||Q==="",it=Ye,ke=r._selfCloseTag,Pe=R(ke)===T.BOOLEAN?Ne&&ke:Ne&&it,st=Pe?"/":"",ut=C(r._attrs,ze,de,We),lt="<".concat(W).concat(ut).concat(st,">"),ct=Re&&!ot&&!at?`
`.concat(me):"",ft=Pe?"":"".concat(Q).concat(ct,"</").concat(W,">");U+="".concat(Le).concat(lt).concat(ft);break}case T.OBJECT:{var Be=Object.keys(r),dt=Be.map(function(B,Z){var ve=l(l({},o),{},{_isFirstItem:Z===0,_isLastItem:Z+1===Be.length,_isOutputStart:se}),ee={_name:B};if(I(r[B])===T.OBJECT){i.forEach(function(ge){var Me=r[B][ge];typeof Me<"u"&&(ee[ge]=Me,delete r[B][ge])});var vt=typeof r[B]._content<"u";if(vt&&Object.keys(r[B]).length>1){var Fe=Object.assign({},r[B]);delete Fe._content,ee._content=[].concat(a(X(Fe)),[r[B]._content])}}typeof ee._content>"u"&&(ee._content=r[B]);var gt=n(ee,ve);return gt},o);U=dt.join("");break}case T.FUNCTION:{var pt=r(o);U=n(pt,o);break}case T.ARRAY:{var mt=r.map(function(B,Z){var ve=l(l({},o),{},{_isFirstItem:Z===0,_isLastItem:Z+1===r.length,_isOutputStart:se});return n(B,ve)});U=mt.join("");break}default:{U=D(r,Ze,xe);break}}return"".concat(Ce).concat(U)};t.toXML=u;var A={toXML:u};t.default=A})})(Ke);var $e={exports:{}};(function(e,t){(function(a,s){s()})(V,function(){function a(c,p){return typeof p>"u"?p={autoBom:!1}:typeof p!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),p={autoBom:!p}),p.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function s(c,p,O){var m=new XMLHttpRequest;m.open("GET",c),m.responseType="blob",m.onload=function(){x(m.response,p,O)},m.onerror=function(){console.error("could not download file")},m.send()}function h(c){var p=new XMLHttpRequest;p.open("HEAD",c,!1);try{p.send()}catch{}return 200<=p.status&&299>=p.status}function g(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var p=document.createEvent("MouseEvents");p.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(p)}}var y=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof V=="object"&&V.global===V?V:void 0,l=y.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),x=y.saveAs||(typeof window!="object"||window!==y?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(c,p,O){var m=y.URL||y.webkitURL,S=document.createElement("a");p=p||c.name||"download",S.download=p,S.rel="noopener",typeof c=="string"?(S.href=c,S.origin===location.origin?g(S):h(S.href)?s(c,p,O):g(S,S.target="_blank")):(S.href=m.createObjectURL(c),setTimeout(function(){m.revokeObjectURL(S.href)},4e4),setTimeout(function(){g(S)},0))}:"msSaveOrOpenBlob"in navigator?function(c,p,O){if(p=p||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(a(c,O),p);else if(h(c))s(c,p,O);else{var m=document.createElement("a");m.href=c,m.target="_blank",setTimeout(function(){g(m)})}}:function(c,p,O,m){if(m=m||open("","_blank"),m&&(m.document.title=m.document.body.innerText="downloading..."),typeof c=="string")return s(c,p,O);var S=c.type==="application/octet-stream",q=/constructor/i.test(y.HTMLElement)||y.safari,R=/CriOS\/[\d]+/.test(navigator.userAgent);if((R||S&&q||l)&&typeof FileReader<"u"){var T=new FileReader;T.onloadend=function(){var i=T.result;i=R?i:i.replace(/^data:[^;]*;/,"data:attachment/file;"),m?m.location.href=i:location=i,m=null},T.readAsDataURL(c)}else{var _=y.URL||y.webkitURL,f=_.createObjectURL(c);m?m.location=f:location.href=f,m=null,setTimeout(function(){_.revokeObjectURL(f)},4e4)}});y.saveAs=x.saveAs=x,e.exports=x})})($e);var ir=$e.exports;const he=yt(ir),sr=({table:e,appId:t,metaData:a,bulkActions:s,storeTableSettings:h,storeColumnSettings:g,refetch:y})=>{J.debug(t,a);let l="csv";const[x,c]=N.useState(l),[p,O]=N.useState(!1),m=N.useMemo(()=>Tt(),[]),S=Lt(t),q=g.filter(v=>v.lookup!==void 0&&S!==void 0&&S[v.columnName]!==void 0).map(v=>{if(S!==void 0&&S[v.columnName]!==void 0){const d={};return d[v.columnName]=S[v.columnName],d}else return null});J.debug("lookupColumns",q);const R=(v,d)=>{if(S!==void 0&&S[v]!==void 0){const u=S[v].filter(A=>A.key===d);if(Array.isArray(u)&&u.length===1)return u[0].value}return d},T=e.getSelectedRowModel().rows,_=T.map(v=>{const d={};return Object.keys(v.original).map(u=>{S!==void 0&&S[u]!==void 0?d[u]=R(u,v.original[u]):d[u]=v.original[u]}),d});J.debug(_),e.getAllColumns();const f=Te({filename:t,fieldSeparator:",",decimalSeparator:".",useKeysAsHeaders:!0}),i=v=>{const d={};if(a.primary_key&&Array.isArray(a.primary_key))for(let u=0;u<a.primary_key.length;u++){const A=a.primary_key[u];d[A]=v[A]}return d},E=v=>{var d,u,A;for(let n=0;n<((d=a==null?void 0:a.columns)==null?void 0:d.length);n++)if(((u=a==null?void 0:a.columns[n])==null?void 0:u.column_name)===v)return(A=a==null?void 0:a.columns[n])==null?void 0:A.data_type;return"varchar"},I=async()=>{},H=()=>{const v=or(f)(_);ar(f)(v)},D=()=>{he(new Blob([JSON.stringify(_)],{type:"text/json;charset=utf-8"}),t+".json")};N.useRef();const K=()=>{const v=T.map(u=>({row:u.original})),d=Ke.toXML({table:v});he(new Blob([d],{type:"text/plain;charset=utf-8"}),t+".xml")},C=()=>{const v=wt(t);J.debug(v);let d="insert into "+v.tbl+" (";for(const u in _[0])d+=u+",";d=d.slice(0,-1)+") values ";for(let u=0;u<_.length;u++){const A=_[u];d+="(";for(const n in A){const r=St(E(n));A[n]===null?d+="null,":r==="number"?d+=A[n]+",":d+="'"+A[n]+"',"}d=d.slice(0,-1),d+="),"}d=d.slice(0,-1)+";",he(new Blob([d],{type:"text/plain;charset=utf-8"}),t+".sql")},X=()=>{for(let v=0;v<_.length;v++){const d=i(_[v]);Ct(t,d,u=>{if(u!=null&&u.code&&(u!=null&&u.message))switch(u.code){case"ok":ue(u.message,{variant:"success"}),y();break;default:J.error(u),ue(u.message??ye.contactSupport,{variant:"error"})}else J.error(u),ue(ye.contactSupport,{variant:"error"})},u=>{J.error("error",u),ue(u??ye.contactSupport,{variant:"error"})})}e.setRowSelection({})},ce=()=>null,fe=()=>null;return w.jsxs(w.Fragment,{children:[w.jsx(Ge,{variant:"popover",popupId:m,children:v=>{var d;return w.jsxs(be,{children:[w.jsx(we,{variant:"contained",endIcon:w.jsx(_t,{}),...qt(v),children:"Bulk Actions"}),w.jsx(Nt,{...Ht(v),anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},sx:{boxShadow:"0px 5px 5px -3px rgba(0,0,0,0.2),0px 8px 10px 1px rgba(0,0,0,0.14),0px 3px 14px 2px rgba(0,0,0,0.12)"},children:w.jsxs(be,{sx:{display:"grid",gap:"20px",padding:"20px"},children:[T.length===0&&w.jsx(kt,{sx:{textAlign:"center",marginTop:"10px"},children:"No rows selected"}),w.jsxs(Bt,{value:x,onChange:(u,A)=>{c(A),u.stopPropagation()},children:[ce(),s.csv&&w.jsx(re,{value:"csv",label:"Export to CSV",control:w.jsx(ne,{})}),s.json&&w.jsx(re,{value:"json",label:"Export to JSON",control:w.jsx(ne,{})}),fe(),s.xml&&w.jsx(re,{value:"xml",label:"Export to XML",control:w.jsx(ne,{})}),s.sql&&!ht(t)&&w.jsx(re,{value:"sql",label:"Export to SQL",control:w.jsx(ne,{})}),((d=a==null?void 0:a.privs)==null?void 0:d.delete)&&!bt(a)&&(s==null?void 0:s.delete)===!0&&h.transactions.delete&&w.jsx(re,{value:"delete",label:"Delete permanently",control:w.jsx(ne,{})})]}),w.jsx(we,{variant:"contained",onClick:()=>{switch(x){case"pdf":I();break;case"csv":H();break;case"json":D();break;case"excel":break;case"xml":K();break;case"sql":C();break;case"delete":O(!0);break}},disabled:T.length===0,children:"Apply"})]})})]})}}),w.jsx(At,{title:"Delete selected row?",message:"Are you sure you want to delete the selected row? This action cannot be undone!",open:p,setOpen:O,onConfirm:()=>{X()},theme:Et})]})},Hr=({table:e,metaData:t,appId:a,bulkActions:s,hasBulkActions:h,storeTableSettings:g,storeColumnSettings:y,refetch:l,showForm:x})=>{var c;return w.jsxs(be,{sx:{display:"flex",flexWrap:"nowrap",gap:"8px",alignItems:"center",whiteSpace:"nowrap"},className:"pp-toolbar-buttons",children:[w.jsx(Ot,{arrow:!0,title:"Refresh Table",className:"ppToolbarRefreshIcon",children:w.jsx(Pt,{onClick:()=>l(),children:w.jsx(jt,{})})}),((c=g==null?void 0:g.transactions)==null?void 0:c.insert)&&w.jsx(we,{variant:"contained",startIcon:w.jsx(Rt,{}),onClick:()=>{x(null,xt.INSERT)},children:"New Record"}),h&&w.jsx(sr,{table:e,appId:a,metaData:t,bulkActions:s,storeTableSettings:g,storeColumnSettings:y,refetch:l})]})};export{Hr as default};
