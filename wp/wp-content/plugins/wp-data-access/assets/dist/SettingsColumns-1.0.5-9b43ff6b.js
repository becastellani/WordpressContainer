import{j as e,cc as J,l as u,b3 as Y,ay as Z,cd as $,r as P,bF as R,bK as m,ce as I,ba as ee,cf as se,cg as ie,ch as te,ci as ae,v as j,cj as ne,ck as re,cl as oe,cm as le,cn as de,co as ce}from"./main-1.0.5.js";import{u as M,S as me,a as pe,I as _,b as ue,c as ge,d as U,D as xe,e as he,f as je,g as fe,h as be,T as ye,M as Se,P as ke}from"./useMetadataColumns-1.0.5-808235db.js";import{u as k,B as g,b as G,M as w,a as ve,a5 as Ne,a6 as Te,a7 as Ae,n as Ee,a8 as Pe,a9 as Me,aa as we,ab as De,ac as Fe,ad as Le,D as Ce}from"./main-1.0.5-a7d73e33.js";import{h as Oe}from"./index.esm-1.0.5-cbf5a94b.js";import{S as x,a as v,C as Re}from"./settings-1.0.5-a609f2d7.js";import{u as A}from"./useTableUpdater-1.0.5-66078c4a.js";import{b as T,F as y,a as S,T as E,A as _e}from"./TextField-1.0.5-7ecf712b.js";import{a as H}from"./ScopeEnum-1.0.5-02ab575a.js";import{P as V}from"./PremiumFeature-1.0.5-90d69706.js";import{b as Ue,c as Be,a as Ge}from"./index.esm-1.0.5-d97070f8.js";import{A as D,a as F,b as L}from"./AccordionSummary-1.0.5-0d0601e8.js";import{F as h}from"./FormControlLabel-1.0.5-d0651878.js";import{R as Ve}from"./RadioGroup-1.0.5-2e2c1c10.js";import{R as B}from"./Radio-1.0.5-9d423ffa.js";import{A as f,a as b}from"./TableContainer-1.0.5-6eccc43a.js";import{C as ze}from"./Checkbox-1.0.5-abd3391a.js";import{I as N}from"./iconBase-1.0.5-f30be7a9.js";import"./useStoreTable-1.0.5-ca420c38.js";import"./AdminTheme-1.0.5-04bcac94.js";import"./ActionsDml-1.0.5-5478d97e.js";import"./MenuItem-1.0.5-151020c5.js";import"./index-1.0.5-198423ad.js";import"./Stepper-1.0.5-49dc98b0.js";import"./Close-1.0.5-697e5a3b.js";import"./DialogContent-1.0.5-383cf0b4.js";import"./Tabs-1.0.5-8b2f6dd8.js";import"./useSlot-1.0.5-9b11ffd5.js";import"./index.esm-1.0.5-4bc9dd12.js";import"./AlertTitle-1.0.5-2a211bdd.js";import"./InputAdornment-1.0.5-b81a1094.js";import"./DateTimePicker-1.0.5-f2511f2b.js";import"./useMobilePicker-1.0.5-94af1d31.js";import"./date-time-utils-1.0.5-d782c334.js";import"./dateViewRenderers-1.0.5-ca3d57b4.js";import"./TimePicker-1.0.5-a761c18a.js";import"./DatePicker-1.0.5-3533cde7.js";import"./index-1.0.5-565e836d.js";import"./vi-1.0.5-b29d2783.js";import"./dayjs.min-1.0.5-ef136ab2.js";const He=({appId:t,columnIndex:o,tableColumn:s})=>{const a=k(),c=A(t);return e.jsxs(g,{sx:{margin:"0 1rem 2rem 1rem"},children:[e.jsx(T,{children:"Width"}),e.jsxs(g,{sx:{display:"grid",gridTemplateColumns:"1fr auto",gridGap:"30px",alignItems:"center"},children:[e.jsx(H,{min:60,max:420,step:1,value:s.width,marks:[{value:60,label:"60"},{value:120,label:"120"},{value:180,label:"180"},{value:240,label:"240"},{value:300,label:"320"},{value:360,label:"360"},{value:420,label:"420"}],valueLabelDisplay:"auto",onChange:(i,l)=>{a(J({appId:t,index:o,width:l})),c(!0),i.stopPropagation()}}),e.jsx("span",{children:"px"})]})]})},We=({appId:t,columnIndex:o,tableColumn:s})=>{var l,n;u.debug(t,o,s),k();const a=Y(Z.getState(),t);M(t,a);const c=G(d=>$(d,t));P.useState(!1),A(t);const i=!0;return e.jsxs(D,{disableGutters:!0,children:[e.jsxs(F,{expandIcon:e.jsx(w,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(Ue,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Column actions"})]}),e.jsxs(L,{sx:{display:"grid",paddingTop:"1rem"},children:[e.jsxs(g,{sx:{margin:"0 10px",display:"grid",gridTemplateColumns:"auto"},children:[s.computedField?e.jsx(h,{control:e.jsx(x,{checked:!1,disabled:!0}),label:"Enable inline search",labelPlacement:"end"}):e.jsx(h,{control:e.jsx(x,{checked:s.inlineSearch&&!i,disabled:i,onChange:(d,C)=>{d.stopPropagation()}}),label:"Enable column filtering",labelPlacement:"end"}),s.inlineSearch&&!i&&e.jsxs(g,{children:[e.jsxs(Ve,{sx:{flexDirection:"column",alignContent:"flex-start",marginLeft:"20px",marginTop:"10px",marginBottom:"10px"},children:[e.jsxs(T,{className:"align-label-radio",children:[e.jsx(B,{checked:s.inlineSearchEnum===R.SEARCHBOX,disabled:!0,onChange:d=>{d.stopPropagation()}}),"Searchbox"]}),e.jsxs(T,{className:"align-label-radio",children:[e.jsx(B,{checked:s.inlineSearchEnum===R.DROPDOWN,disabled:!0,onChange:d=>{d.stopPropagation()}}),"Drop-down list"]}),e.jsxs(T,{className:"align-label-radio",children:[e.jsx(B,{checked:s.inlineSearchEnum===R.MULTISELECT,disabled:!0,onChange:d=>{d.stopPropagation()}}),"Multi-select drop-down list"]})]}),e.jsx(e.Fragment,{children:s.lookup!==void 0&&((l=s.lookup)==null?void 0:l.loadOnStartup)!==!0&&e.jsx(y,{sx:{marginBottom:"20px"},children:e.jsxs(S,{sx:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(ve,{size:"24px"}),e.jsx("span",{children:"Drop-down list are only supported for lookups loaded into memory on startup."})]})})})]}),((n=a==null?void 0:a.privs)==null?void 0:n.update)&&a.primary_key.length>0&&e.jsx(e.Fragment,{children:s.computedField?e.jsx(h,{control:e.jsx(x,{checked:!1,disabled:!0}),label:"Enable inline editing",labelPlacement:"end"}):e.jsx(h,{control:e.jsx(x,{checked:c&&s.visible&&s.inlineEditing,disabled:!0,onChange:(d,C)=>{d.stopPropagation()}}),label:"Enable inline editing",labelPlacement:"end"})})]}),!1,e.jsx(V,{})]})]})},qe=({appId:t,columnIndex:o,tableColumn:s})=>{const a=k(),c=A(t),i=M(t),l=(n,d)=>{u.debug(n,d)};return e.jsxs(D,{disableGutters:!0,children:[e.jsxs(F,{expandIcon:e.jsx(w,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(Be,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Column settings"})]}),e.jsxs(L,{sx:{display:"grid",gridGap:"2rem",paddingTop:"1rem"},children:[!s.computedField&&i[s.columnName]!==void 0&&m(i[s.columnName].data_type)==="string"&&i[s.columnName].data_type!=="enum"&&i[s.columnName].data_type!=="set"&&e.jsxs(y,{children:[e.jsx(h,{control:e.jsx(x,{checked:s.allowMarkup,onChange:(n,d)=>{a(I({appId:t,index:o,allowMarkup:d})),c(!0),n.stopPropagation()}}),label:"Allow inline HTML",labelPlacement:"end"}),e.jsx(S,{children:"Allows users to use markup in column content. Enabling this feature can generate cross-site scripting (XSS) messages."})]}),e.jsxs(g,{sx:{display:"grid",gridTemplateColumns:"auto"},children:[e.jsx(h,{control:e.jsx(x,{checked:!1,disabled:!0,onClick:n=>{l(o,!s.visibleTablet),n.stopPropagation()}}),label:"Show column on tablet",labelPlacement:"end"}),e.jsx(h,{control:e.jsx(x,{checked:!1,disabled:!0,onClick:n=>{n.stopPropagation()}}),label:"Show column on mobile",labelPlacement:"end"})]}),(s.computedField||i[s.columnName]!==void 0&&(m(i[s.columnName].data_type)==="float"||m(i[s.columnName].data_type)==="number"||m(i[s.columnName].data_type)==="date"||m(i[s.columnName].data_type)==="time"||m(i[s.columnName].data_type)==="datetime"))&&e.jsx(g,{children:e.jsxs(y,{children:[e.jsx(h,{control:e.jsx(x,{checked:!1,disabled:!0,onClick:n=>{n.stopPropagation()}}),label:"Localize numeric value",labelPlacement:"end"}),e.jsx(S,{children:s.computedField||i[s.columnName]!==void 0&&(m(i[s.columnName].data_type)==="float"||m(i[s.columnName].data_type)==="number")?"Localizes decimal and thousands seperators (does not affect inline fields)":"Localizes date and time fields (does not affect inline fields)"})]})}),i[s.columnName]!==void 0&&(m(i[s.columnName].data_type)==="float"||s.computedField)&&e.jsxs(y,{children:[e.jsx(T,{children:"Decimals"}),e.jsx(H,{min:0,max:6,value:s.decimals,marks:[{value:0,label:"0"},{value:1,label:"1"},{value:2,label:"2"},{value:3,label:"3"},{value:4,label:"4"},{value:5,label:"5"},{value:6,label:"âˆž"}],valueLabelDisplay:"auto",disabled:!0,onChange:(n,d)=>{u.debug(d),n.stopPropagation()}}),e.jsx(S,{children:"Number of decimals displayed"})]}),i[s.columnName]!==void 0&&(m(i[s.columnName].data_type)==="date"||m(i[s.columnName].data_type)==="datetime")&&e.jsx(g,{children:e.jsx(y,{children:e.jsx(h,{control:e.jsx(x,{checked:!1,disabled:!0,onClick:n=>{n.stopPropagation()}}),label:"Add trailing zeros to days and month",labelPlacement:"end"})})}),i[s.columnName]!==void 0&&(m(i[s.columnName].data_type)==="time"||m(i[s.columnName].data_type)==="datetime")&&e.jsx(g,{children:e.jsx(y,{children:e.jsx(h,{control:e.jsx(x,{checked:!1,disabled:!0,onClick:n=>{n.stopPropagation()}}),label:"Add trailing zeros to hours, minutes and seconds",labelPlacement:"end"})})}),e.jsxs(y,{children:[e.jsxs(g,{sx:{display:"grid",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(E,{type:"text",variant:"outlined",label:"Prefix",value:s.prefix,disabled:!0,InputLabelProps:{shrink:!0},onChange:n=>{n.stopPropagation()}}),e.jsx(E,{type:"text",variant:"outlined",label:"Suffix",value:s.suffix,disabled:!0,InputLabelProps:{shrink:!0},onChange:n=>{n.stopPropagation()}})]}),e.jsx(S,{children:"Adds a prefix and/or suffix to the column content (also added to inline text and number fields)"})]}),e.jsxs(y,{children:[e.jsx(E,{type:"text",variant:"outlined",label:"CSS classes",fullWidth:!0,value:s.classNames,disabled:!0,InputLabelProps:{shrink:!0},onChange:n=>{n.stopPropagation()}}),e.jsx(S,{children:"CSS classes (seperated by spaces) for custom styling"})]}),e.jsx(V,{single:!1,margin:"0"})]})]})},Qe=[{key:f.SUM,label:b.SUM},{key:f.MIN,label:b.MIN},{key:f.MAX,label:b.MAX},{key:f.AVG,label:b.AVG},{key:f.COUNT,label:b.COUNT},{key:f.UNIQUE,label:b.UNIQUE},{key:f.STD,label:b.STD},{key:f.VARIANCE,label:b.VARIANCE},{key:f.MEDIAN,label:b.MEDIAN}],z=[...Qe],Xe=({appId:t,columnIndex:o,tableColumn:s})=>{u.debug(t,o,s),k(),A(t);const a=M(t),c=P.useMemo(()=>{var i;return(s==null?void 0:s.aggregation)===void 0?[]:(i=s==null?void 0:s.aggregation)==null?void 0:i.map(l=>z.filter(n=>n.key===l)[0])},[s==null?void 0:s.aggregation]);return!ee(t)||s.computedField===void 0&&m(a[s.columnName].data_type)!=="number"?null:e.jsxs(D,{disableGutters:!0,children:[e.jsxs(F,{expandIcon:e.jsx(w,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(Ge,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Aggregations"})]}),e.jsxs(L,{sx:{marginTop:"10px"},children:[e.jsxs(y,{fullWidth:!0,children:[e.jsx(_e,{multiple:!0,options:z,disabled:!0,disableCloseOnSelect:!0,getOptionLabel:i=>i.label,value:c,onChange:(i,l)=>{i.stopPropagation()},renderOption:(i,l,{selected:n})=>e.jsxs("li",{...i,children:[e.jsx(ze,{icon:e.jsx(Ne,{}),checkedIcon:e.jsx(Te,{}),style:{marginRight:8},checked:n}),l.label]}),renderInput:i=>e.jsx(E,{...i,label:"Select from list"})}),e.jsx(S,{children:"Allows multiple selections. Displayed in order of entry."})]}),e.jsx(V,{})]})]})},Ke=({appId:t,columnIndex:o,tableColumn:s})=>{u.debug(t,o,s);const a=k(),i=M(t)[s.columnName],l=(n,d)=>{a(se({appId:t,columnName:s.columnName})),a(ie({appId:t,columnName:s.columnName})),a(te({appId:t,index:n,lookup:d}))};return e.jsxs(e.Fragment,{children:[e.jsx(He,{appId:t,columnIndex:o,tableColumn:s}),e.jsx(qe,{appId:t,columnIndex:o,tableColumn:s}),e.jsx(We,{appId:t,columnIndex:o,tableColumn:s}),e.jsx(me,{appId:t,columnIndex:o,tableColumn:s,columnMetaData:i,setLookup:l}),e.jsx(Xe,{appId:t,columnIndex:o,tableColumn:s}),e.jsx(pe,{columnMetaData:i})]})},Je=({appId:t,columnIndex:o})=>{u.debug(t,o);const s=k(),a=G(r=>ae(r,t,o));u.debug("tableColumn",a);const c=A(t),[i,l]=P.useState(!1),[n,d]=P.useState(void 0),C=r=>{r!==void 0&&(s(ne({appId:t,index:r})),c(!0))},W=(r,p)=>{u.debug(r,p),s(re({appId:t,index:r,visible:p})),c(!0)},q=(r,p)=>{u.debug(r,p),s(oe({appId:t,index:r,queryable:p})),c(!0)},Q=(r,p)=>{u.debug(r,p),s(le({appId:t,index:r,orderable:p})),c(!0)},O=(r,p)=>{s(de({appId:t,index:r,alignment:p})),c(!0)},X=(r,p,K)=>(u.debug(r,p,K),e.jsxs(e.Fragment,{children:[e.jsx(g,{sx:{"& svg":{pointerEvents:"none",opacity:"0.5"}},children:e.jsx(ue,{id:r,enabled:!1},r)}),e.jsxs(g,{sx:{display:"inline-grid",gridTemplateColumns:a.computedField!==void 0?"auto auto":"auto",justifyContent:"start",alignItems:"center",gap:"10px","& svg":{opacity:"0.5"}},children:[a.computedField!==void 0&&e.jsx(Oe,{}),e.jsx(T,{children:p})]})]}));return e.jsxs(e.Fragment,{children:[e.jsxs(D,{disableGutters:!0,slotProps:{transition:{unmountOnExit:!0}},children:[e.jsxs(F,{className:"pp-column-settings",expandIcon:e.jsx(w,{}),sx:{justifyContent:"space-between"},children:[e.jsx(g,{sx:{display:"grid",gridTemplateColumns:"auto 1fr",alignItems:"center","& svg":{display:"flex"}},children:X(a.columnName,a.columnLabel,o)}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"40px 40px 40px 40px"},children:[e.jsx(v,{title:"Visibility",position:"bottom",children:e.jsx(N,{onClick:r=>{W(o,!a.visible),r.stopPropagation()},children:e.jsx(_,{checked:a.visible,children:e.jsx(Ae,{})})})}),a.computedField?e.jsx(v,{title:"Edit",position:"bottom",children:e.jsx(N,{onClick:r=>{r.stopPropagation()},children:e.jsx(Pe,{})})}):e.jsx(v,{title:"Searchable",position:"bottom",children:e.jsx(N,{onClick:r=>{q(o,!a.queryable),r.stopPropagation()},children:e.jsx(_,{checked:a.queryable,alignRight:!1,children:e.jsx(Ee,{})})})}),a.computedField?e.jsx(v,{title:"Delete",position:"bottom",children:e.jsx(N,{onClick:r=>{d(o),l(!0),r.stopPropagation()},children:e.jsx(we,{})})}):e.jsx(v,{title:"Sortable",position:"bottom",children:e.jsx(N,{onClick:r=>{Q(o,!a.orderable),r.stopPropagation()},children:e.jsx(_,{checked:a.orderable,children:e.jsx(Me,{})})})}),e.jsx(v,{title:"Alignment",position:"bottom",children:e.jsxs(N,{onClick:r=>{a.alignment===j.LEFT?O(o,j.CENTER):a.alignment===j.CENTER?O(o,j.RIGHT):a.alignment===j.RIGHT&&O(o,j.LEFT),c(!0),r.stopPropagation()},children:[a.alignment===j.LEFT&&e.jsx(De,{}),a.alignment===j.CENTER&&e.jsx(Fe,{}),a.alignment===j.RIGHT&&e.jsx(Le,{})]})})]})]}),e.jsx(L,{children:e.jsx(Ke,{appId:t,columnIndex:o,tableColumn:a})})]},o),e.jsx(Re,{title:"Delete computed field?",message:"Are you sure you want to delete this computed field? This action cannot be undone!",open:i,setOpen:l,onConfirm:()=>C(n)})]})},Os=({appId:t,metaData:o})=>{u.debug(t,o),k();const s=ge(U(ke),U(Se),U(ye));A(t);const a=i=>{const{active:l,over:n}=i;u.debug(l,n),l==null||l.id,n==null||n.id},c=G(i=>ce(i,t));return c===void 0||c.length===0?null:e.jsxs(e.Fragment,{children:[e.jsx(xe,{autoScroll:!0,sensors:s,collisionDetection:he,onDragEnd:a,children:e.jsx(je,{items:c,children:c.map((i,l)=>e.jsx(fe,{id:i,children:e.jsx(Je,{appId:t,columnIndex:l})},i))})}),e.jsx(be,{appId:t,target:Ce.TABLE})]})};export{Os as default};
